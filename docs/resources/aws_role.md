---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "spacelift_aws_role Resource - terraform-provider-spacelift"
subcategory: ""
description: |-
  spacelift_aws_role represents cross-account IAM role delegation https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html between the Spacelift worker and an individual stack or module. If this is set, Spacelift will use AWS STS to assume the supplied IAM role and put its temporary credentials in the runtime environment.
  If you use private workers, you can also assume IAM role on the worker side using your own AWS credentials (e.g. from EC2 instance profile).
  Note: when assuming credentials for shared worker, Spacelift will use $accountName@$stackID or $accountName@$moduleID as external ID https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html and $runID@$stackID@$accountName truncated to 64 characters as session ID https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.
---

# spacelift_aws_role (Resource)

`spacelift_aws_role` represents [cross-account IAM role delegation](https://docs.aws.amazon.com/IAM/latest/UserGuide/tutorial_cross-account-with-roles.html) between the Spacelift worker and an individual stack or module. If this is set, Spacelift will use AWS STS to assume the supplied IAM role and put its temporary credentials in the runtime environment.

If you use private workers, you can also assume IAM role on the worker side using your own AWS credentials (e.g. from EC2 instance profile).

Note: when assuming credentials for **shared worker**, Spacelift will use `$accountName@$stackID` or `$accountName@$moduleID` as [external ID](https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html) and `$runID@$stackID@$accountName` truncated to 64 characters as [session ID](https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole).

## Example Usage

```terraform
# Assuming the role in Spacelift
resource "aws_iam_role" "spacelift" {
  name = "spacelift"

  assume_role_policy = jsonencode({
    Version   = "2012-10-17"
    Statement = [jsondecode(spacelift_stack.k8s-core.aws_assume_role_policy_statement)]
  })
}

resource "aws_iam_role_policy_attachment" "spacelift" {
  role       = aws_iam_role.spacelift.name
  policy_arn = "arn:aws:iam::aws:policy/PowerUserAccess"
}

# Role assumed by a Stack
resource "spacelift_aws_role" "spacelift-stack" {
  stack_id = "k8s-core"
  role_arn = aws_iam_role.spacelift.arn
}

# Role assumed by a Module
resource "spacelift_aws_role" "spacelift-module" {
  module_id = "k8s-core"
  role_arn  = aws_iam_role.spacelift.arn
}

# Assuming the role in the private worker, for a stack.
resource "spacelift_aws_role" "k8s-core" {
  stack_id                       = "k8s-core"
  role_arn                       = "arn:aws:iam::123456789012:custom/role"
  generate_credentials_in_worker = true
}

# Assuming the role in the private worker, for a module.
resource "spacelift_aws_role" "k8s-core" {
  module_id                      = "k8s-core"
  role_arn                       = "arn:aws:iam::123456789012:custom/role"
  generate_credentials_in_worker = true
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- **role_arn** (String) ARN of the AWS IAM role to attach

### Optional

- **external_id** (String) Custom external ID (works only for private workers).
- **generate_credentials_in_worker** (Boolean) Generate AWS credentials in the private worker
- **id** (String) The ID of this resource.
- **module_id** (String) ID of the module which assumes the AWS IAM role
- **stack_id** (String) ID of the stack which assumes the AWS IAM role

## Import

Import is supported using the following syntax:

```shell
terraform import spacelift_aws_role.k8s-core stack/$STACK_ID

terraform import spacelift_aws_role.k8s-core module/$MODULE_ID
```
